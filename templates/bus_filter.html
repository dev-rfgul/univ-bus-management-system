<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Available Buses</title>
  </head>
  <body>
    <h2>Filter Buses</h2>
    <form method="POST">
      {% csrf_token %}
      <label for="stop">Start Location :</label>
      <input type="text" name="start_location" placeholder="e.g. main cafe" required class="form-input" />
      <label for="stop">Enter Your Stop:</label>
      <input type="text" name="stop" placeholder="e.g. main cafe" required class="form-input" />
      <button type="submit" class="btn">Find Buses</button>
    </form>
    

    <h2>Available Buses</h2>
    <ul>
      {% for bus in buses %}
        <li>
        Bus Number:  {{ bus }} - remaining seats: {{ bus.available_seats }} Departure Time  {{bus.departure_time}}

          {% if user.is_authenticated %}
            <form method="POST" action="{% url 'register_bus' bus.id %}">
              {% csrf_token %}
              <button type="submit">Register</button>
            </form>
          {% else %}
            <p><a href="{% url 'login' %}">Login to Register</a></p>
          {% endif %}
        </li>
      {% empty %}
        <li>No buses available for the selected route, stop, and time.</li>
      {% endfor %}
    </ul>
  </body>
</html>
